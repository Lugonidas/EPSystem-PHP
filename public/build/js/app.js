document.addEventListener("DOMContentLoaded",(function(){iniciarApp()}));const venta={nombre:"",fecha:"",hora:"",total:"",productos:[]},menuMobile=document.querySelector(".mobile"),darkMode=document.querySelector(".btn-dark-mode"),buscador=document.querySelector("#buscador"),agregar=document.querySelector(".agregar"),items=document.querySelector("#items");let idSeleccionado=null,carrito={};function iniciarApp(){}async function consultarAPI(){try{const t="http://localhost:3000/api/productos",e=await fetch(t);buscarProducto(await e.json(),idSeleccionado)}catch(t){console.log(t)}}function buscarProducto(t,e){t.forEach(t=>{let o=!1;if(t.id===e&&(o=!0,o)){agregar.dataset.id=e;document.querySelector("#nombreProducto").textContent=t.nombre,document.querySelector("#precioProducto").textContent=t.precioVenta;agregar.addEventListener("click",agregarCarrito);document.querySelector("#cantidadProducto").textContent=1}}),e=0}function agregarCarrito(){setCarrito(document.querySelector("#acciones").parentElement)}function mostrarCarrito(){items.innerHTML="";const t=document.querySelector("#template-carrito").content,e=document.createDocumentFragment();Object.values(carrito).forEach(o=>{t.querySelector("#carritoCodigo").textContent=o.id,t.querySelector("#carritoNombre").textContent=o.nombre,t.querySelector("#carritoCantidad").textContent=o.cantidad,t.querySelector("#carritoTotal").textContent=o.precio*o.cantidad,t.querySelector("#acciones .mas").dataset.id=o.id,t.querySelector("#acciones .menos").dataset.id=o.id;const r=t.cloneNode(!0);e.appendChild(r)}),items.appendChild(e),pintarFooter(),venta.productos=carrito,venta.total=t.querySelector("#carritoTotal").textContent}menuMobile&&menuMobile.addEventListener("click",(function(){document.querySelector(".links").classList.toggle("mostrar");document.querySelectorAll(".fa-bars").forEach(t=>{t.classList.toggle("mostrar")})})),darkMode&&darkMode.addEventListener("click",(function(){document.querySelector("#body").classList.toggle("dark-mode")})),buscador&&buscador.addEventListener("input",(function(t){idSeleccionado=t.target.value,consultarAPI()})),items.addEventListener("click",t=>{btnAccion(t)});const footer=document.querySelector("#footer-carrito");function pintarFooter(){footer.innerHTML="";const t=document.querySelector("#template-footer").content,e=document.createDocumentFragment(),o=Object.values(carrito).reduce((t,{cantidad:e})=>t+e,0),r=Object.values(carrito).reduce((t,{cantidad:e,precio:o})=>t+e*o,0);t.querySelector("#cantidad-productos").textContent=o,t.querySelector("#total-productos").textContent=r;const a=t.cloneNode(!0);e.appendChild(a),footer.appendChild(e)}function setCarrito(t){const e={id:t.querySelector(".agregar").dataset.id,nombre:t.querySelector("#nombreProducto").textContent,precio:t.querySelector("#precioProducto").textContent,cantidad:t.querySelector("#cantidadProducto").textContent=1};carrito.hasOwnProperty(e.id)&&(e.cantidad=carrito[e.id].cantidad+1),carrito[e.id]={...e},mostrarCarrito()}function btnAccion(t){if(t.target.classList.contains("mas")){const e=carrito[t.target.dataset.id];e.cantidad=carrito[t.target.dataset.id].cantidad+1,carrito[t.target.dataset.id]={...e},mostrarCarrito()}if(t.target.classList.contains("menos")){const e=carrito[t.target.dataset.id];e.cantidad=carrito[t.target.dataset.id].cantidad-1,carrito[t.target.dataset.id]={...e},mostrarCarrito()}}